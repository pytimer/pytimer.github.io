<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Software Develper, **Like Go and Kubernetes** Golang developer China Pytimer https://raw.githubusercontent.com/pytimer/pytimer.github.io/master/gopher.png ">
<meta name="description" content="External Admission Webhooks 作用及使用场景 当需要对某些api请求或者所有请求进行校验或者修改object的时候，可以考虑使用ValidatingAdmissionWebhook或者MutatingAdmissionWebhook，两者的区别：
 ValidatingAdmissionWebhook不允许在webhook中对Object进行修改，只是返回结果是true或false MutatingAdmissionWebhook运行在webhook中对Object进行修改  启用 在1.10之前的版本，需要使用 --admission-control 启用相关配置，并且是按配置的顺序来决定运行顺序，因此需要用户对于Admission Controllers 完全了解。
在1.10之后的版本，上述配置已经废弃，建议使用--enable-admission-plugins=MutatingAdmissionWebhook,ValidatingAdmissionWebhook，并且用户指定的顺序并不会影响实际运行顺序，更加友好。
官方的Using Admission Controllers - Kubernetes有关于这方面的详细说明。
流程 kube-apiserver &amp;ndash;&amp;gt; 认证鉴权 &amp;ndash;&amp;gt; Admission Controller &amp;ndash;&amp;gt; webhook
使用 创建admission服务，以供kube-apiserver调用 package main import ( &amp;#34;crypto/tls&amp;#34; &amp;#34;encoding/json&amp;#34; &amp;#34;flag&amp;#34; &amp;#34;io/ioutil&amp;#34; &amp;#34;net/http&amp;#34; admissionv1beta1 &amp;#34;k8s.io/api/admission/v1beta1&amp;#34; admissionregistrationv1beta1 &amp;#34;k8s.io/api/admissionregistration/v1beta1&amp;#34; corev1 &amp;#34;k8s.io/api/core/v1&amp;#34; metav1 &amp;#34;k8s.io/apimachinery/pkg/apis/meta/v1&amp;#34; &amp;#34;k8s.io/apimachinery/pkg/runtime&amp;#34; &amp;#34;k8s.io/apimachinery/pkg/runtime/serializer&amp;#34; utilruntime &amp;#34;k8s.io/apimachinery/pkg/util/runtime&amp;#34; &amp;#34;k8s.io/klog&amp;#34; ) type patchOperation struct { Op string `json:&amp;#34;op&amp;#34;` Path string `json:&amp;#34;path&amp;#34;` Value interface{} `json:&amp;#34;value,omitempty&amp;#34;` } var scheme = runtime." />
<meta name="keywords" content=", admission webhook" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://pytimer.github.io/post/cncf/kubernetes/kube-admission/" />


    <title>
        
            Kube Admission :: Pytimer  — Kubernetes爱好者
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d1ea4af8fd04fb24a4f8b882ea54bd04eb245427ca4baf527c81a5dab071410b.css">






<meta itemprop="name" content="Kube Admission">
<meta itemprop="description" content="External Admission Webhooks 作用及使用场景 当需要对某些api请求或者所有请求进行校验或者修改object的时候，可以考虑使用ValidatingAdmissionWebhook或者MutatingAdmissionWebhook，两者的区别：
 ValidatingAdmissionWebhook不允许在webhook中对Object进行修改，只是返回结果是true或false MutatingAdmissionWebhook运行在webhook中对Object进行修改  启用 在1.10之前的版本，需要使用 --admission-control 启用相关配置，并且是按配置的顺序来决定运行顺序，因此需要用户对于Admission Controllers 完全了解。
在1.10之后的版本，上述配置已经废弃，建议使用--enable-admission-plugins=MutatingAdmissionWebhook,ValidatingAdmissionWebhook，并且用户指定的顺序并不会影响实际运行顺序，更加友好。
官方的Using Admission Controllers - Kubernetes有关于这方面的详细说明。
流程 kube-apiserver &ndash;&gt; 认证鉴权 &ndash;&gt; Admission Controller &ndash;&gt; webhook
使用 创建admission服务，以供kube-apiserver调用 package main import ( &#34;crypto/tls&#34; &#34;encoding/json&#34; &#34;flag&#34; &#34;io/ioutil&#34; &#34;net/http&#34; admissionv1beta1 &#34;k8s.io/api/admission/v1beta1&#34; admissionregistrationv1beta1 &#34;k8s.io/api/admissionregistration/v1beta1&#34; corev1 &#34;k8s.io/api/core/v1&#34; metav1 &#34;k8s.io/apimachinery/pkg/apis/meta/v1&#34; &#34;k8s.io/apimachinery/pkg/runtime&#34; &#34;k8s.io/apimachinery/pkg/runtime/serializer&#34; utilruntime &#34;k8s.io/apimachinery/pkg/util/runtime&#34; &#34;k8s.io/klog&#34; ) type patchOperation struct { Op string `json:&#34;op&#34;` Path string `json:&#34;path&#34;` Value interface{} `json:&#34;value,omitempty&#34;` } var scheme = runtime.">
<meta itemprop="datePublished" content="2018-12-17T09:51:57+08:00" />
<meta itemprop="dateModified" content="2018-12-17T09:51:57+08:00" />
<meta itemprop="wordCount" content="781">
<meta itemprop="image" content="https://pytimer.github.io/"/>



<meta itemprop="keywords" content="admission webhook," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://pytimer.github.io/"/>

<meta name="twitter:title" content="Kube Admission"/>
<meta name="twitter:description" content="External Admission Webhooks 作用及使用场景 当需要对某些api请求或者所有请求进行校验或者修改object的时候，可以考虑使用ValidatingAdmissionWebhook或者MutatingAdmissionWebhook，两者的区别：
 ValidatingAdmissionWebhook不允许在webhook中对Object进行修改，只是返回结果是true或false MutatingAdmissionWebhook运行在webhook中对Object进行修改  启用 在1.10之前的版本，需要使用 --admission-control 启用相关配置，并且是按配置的顺序来决定运行顺序，因此需要用户对于Admission Controllers 完全了解。
在1.10之后的版本，上述配置已经废弃，建议使用--enable-admission-plugins=MutatingAdmissionWebhook,ValidatingAdmissionWebhook，并且用户指定的顺序并不会影响实际运行顺序，更加友好。
官方的Using Admission Controllers - Kubernetes有关于这方面的详细说明。
流程 kube-apiserver &ndash;&gt; 认证鉴权 &ndash;&gt; Admission Controller &ndash;&gt; webhook
使用 创建admission服务，以供kube-apiserver调用 package main import ( &#34;crypto/tls&#34; &#34;encoding/json&#34; &#34;flag&#34; &#34;io/ioutil&#34; &#34;net/http&#34; admissionv1beta1 &#34;k8s.io/api/admission/v1beta1&#34; admissionregistrationv1beta1 &#34;k8s.io/api/admissionregistration/v1beta1&#34; corev1 &#34;k8s.io/api/core/v1&#34; metav1 &#34;k8s.io/apimachinery/pkg/apis/meta/v1&#34; &#34;k8s.io/apimachinery/pkg/runtime&#34; &#34;k8s.io/apimachinery/pkg/runtime/serializer&#34; utilruntime &#34;k8s.io/apimachinery/pkg/util/runtime&#34; &#34;k8s.io/klog&#34; ) type patchOperation struct { Op string `json:&#34;op&#34;` Path string `json:&#34;path&#34;` Value interface{} `json:&#34;value,omitempty&#34;` } var scheme = runtime."/>





    <meta property="article:section" content="Kubernetes" />



    <meta property="article:published_time" content="2018-12-17 09:51:57 &#43;0800 CST" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://pytimer.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ kubectl</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://pytimer.github.io/post">博客</a></li><li><a href="https://pytimer.github.io/categories">类别</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://pytimer.github.io/post/cncf/kubernetes/kube-admission/">Kube Admission</a></h2>

            

            <div class="post-content">
                <h2 id="external-admission-webhooks">External Admission Webhooks</h2>
<h3 id="作用及使用场景">作用及使用场景</h3>
<p>当需要对某些api请求或者所有请求进行校验或者修改object的时候，可以考虑使用ValidatingAdmissionWebhook或者MutatingAdmissionWebhook，两者的区别：</p>
<ul>
<li>ValidatingAdmissionWebhook不允许在webhook中对Object进行修改，只是返回结果是true或false</li>
<li>MutatingAdmissionWebhook运行在webhook中对Object进行修改</li>
</ul>
<h3 id="启用">启用</h3>
<p>在1.10之前的版本，需要使用 <code>--admission-control</code> 启用相关配置，并且是按配置的顺序来决定运行顺序，因此需要用户对于Admission Controllers 完全了解。</p>
<p>在1.10之后的版本，上述配置已经废弃，建议使用<code>--enable-admission-plugins=MutatingAdmissionWebhook,ValidatingAdmissionWebhook</code>，并且用户指定的顺序并不会影响实际运行顺序，更加友好。</p>
<p>官方的<a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/">Using Admission Controllers - Kubernetes</a>有关于这方面的详细说明。</p>
<h3 id="流程">流程</h3>
<p>kube-apiserver &ndash;&gt; 认证鉴权 &ndash;&gt; Admission Controller &ndash;&gt; webhook</p>
<h3 id="使用">使用</h3>
<h4 id="创建admission服务以供kube-apiserver调用">创建admission服务，以供kube-apiserver调用</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;crypto/tls&#34;</span>
	<span style="color:#e6db74">&#34;encoding/json&#34;</span>
	<span style="color:#e6db74">&#34;flag&#34;</span>
	<span style="color:#e6db74">&#34;io/ioutil&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>

	<span style="color:#a6e22e">admissionv1beta1</span> <span style="color:#e6db74">&#34;k8s.io/api/admission/v1beta1&#34;</span>
	<span style="color:#a6e22e">admissionregistrationv1beta1</span> <span style="color:#e6db74">&#34;k8s.io/api/admissionregistration/v1beta1&#34;</span>
	<span style="color:#a6e22e">corev1</span> <span style="color:#e6db74">&#34;k8s.io/api/core/v1&#34;</span>
	<span style="color:#a6e22e">metav1</span> <span style="color:#e6db74">&#34;k8s.io/apimachinery/pkg/apis/meta/v1&#34;</span>
	<span style="color:#e6db74">&#34;k8s.io/apimachinery/pkg/runtime&#34;</span>
	<span style="color:#e6db74">&#34;k8s.io/apimachinery/pkg/runtime/serializer&#34;</span>
	<span style="color:#a6e22e">utilruntime</span> <span style="color:#e6db74">&#34;k8s.io/apimachinery/pkg/util/runtime&#34;</span>
	<span style="color:#e6db74">&#34;k8s.io/klog&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">patchOperation</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Op</span>    <span style="color:#66d9ef">string</span>      <span style="color:#e6db74">`json:&#34;op&#34;`</span>
	<span style="color:#a6e22e">Path</span>  <span style="color:#66d9ef">string</span>      <span style="color:#e6db74">`json:&#34;path&#34;`</span>
	<span style="color:#a6e22e">Value</span> <span style="color:#66d9ef">interface</span>{} <span style="color:#e6db74">`json:&#34;value,omitempty&#34;`</span>
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">scheme</span> = <span style="color:#a6e22e">runtime</span>.<span style="color:#a6e22e">NewScheme</span>()
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">codecs</span> = <span style="color:#a6e22e">serializer</span>.<span style="color:#a6e22e">NewCodecFactory</span>(<span style="color:#a6e22e">scheme</span>)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">init</span>() {
	<span style="color:#a6e22e">addToScheme</span>(<span style="color:#a6e22e">scheme</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">addToScheme</span>(<span style="color:#a6e22e">scheme</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">runtime</span>.<span style="color:#a6e22e">Scheme</span>) {
	<span style="color:#a6e22e">utilruntime</span>.<span style="color:#a6e22e">Must</span>(<span style="color:#a6e22e">corev1</span>.<span style="color:#a6e22e">AddToScheme</span>(<span style="color:#a6e22e">scheme</span>))
	<span style="color:#a6e22e">utilruntime</span>.<span style="color:#a6e22e">Must</span>(<span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AddToScheme</span>(<span style="color:#a6e22e">scheme</span>))
	<span style="color:#a6e22e">utilruntime</span>.<span style="color:#a6e22e">Must</span>(<span style="color:#a6e22e">admissionregistrationv1beta1</span>.<span style="color:#a6e22e">AddToScheme</span>(<span style="color:#a6e22e">scheme</span>))
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">toAdmissionResponse</span>(<span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionResponse</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionResponse</span>{
		<span style="color:#a6e22e">Result</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">metav1</span>.<span style="color:#a6e22e">Status</span>{
			<span style="color:#a6e22e">Message</span>: <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>(),
		},
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">updateAnnotation</span>(<span style="color:#a6e22e">target</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">added</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">patch</span> []<span style="color:#a6e22e">patchOperation</span>) {
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">target</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#a6e22e">target</span>)
		<span style="color:#a6e22e">target</span> = <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{}
	}
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">value</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">added</span> {
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">target</span>[<span style="color:#a6e22e">key</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
			<span style="color:#a6e22e">patch</span> = append(<span style="color:#a6e22e">patch</span>, <span style="color:#a6e22e">patchOperation</span>{
				<span style="color:#a6e22e">Op</span>:    <span style="color:#e6db74">&#34;add&#34;</span>,
				<span style="color:#a6e22e">Path</span>:  <span style="color:#e6db74">&#34;/metadata/annotations/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">key</span>,
				<span style="color:#a6e22e">Value</span>: <span style="color:#a6e22e">value</span>,
			})
		} <span style="color:#66d9ef">else</span> {
			<span style="color:#a6e22e">patch</span> = append(<span style="color:#a6e22e">patch</span>, <span style="color:#a6e22e">patchOperation</span>{
				<span style="color:#a6e22e">Op</span>:    <span style="color:#e6db74">&#34;replace&#34;</span>,
				<span style="color:#a6e22e">Path</span>:  <span style="color:#e6db74">&#34;/metadata/annotations/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">key</span>,
				<span style="color:#a6e22e">Value</span>: <span style="color:#a6e22e">value</span>,
			})
		}
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">patch</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">mutatePods</span>(<span style="color:#a6e22e">ar</span> <span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionReview</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionResponse</span> {
	<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">V</span>(<span style="color:#ae81ff">2</span>).<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;Inject pods.&#34;</span>)

	<span style="color:#a6e22e">podResource</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">metav1</span>.<span style="color:#a6e22e">GroupVersionResource</span>{<span style="color:#a6e22e">Group</span>: <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">Version</span>: <span style="color:#e6db74">&#34;v1&#34;</span>, <span style="color:#a6e22e">Resource</span>: <span style="color:#e6db74">&#34;pods&#34;</span>}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">Resource</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">podResource</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#e6db74">&#34;expect resource to be %s&#34;</span>, <span style="color:#a6e22e">podResource</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
	}

	<span style="color:#a6e22e">raw</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ar</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">Object</span>.<span style="color:#a6e22e">Raw</span>
	<span style="color:#a6e22e">pod</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">corev1</span>.<span style="color:#a6e22e">Pod</span>{}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">codecs</span>.<span style="color:#a6e22e">UniversalDeserializer</span>().<span style="color:#a6e22e">Decode</span>(<span style="color:#a6e22e">raw</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pod</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">toAdmissionResponse</span>(<span style="color:#a6e22e">err</span>)
	}

	<span style="color:#a6e22e">reviewResponse</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionResponse</span>{}
	<span style="color:#a6e22e">reviewResponse</span>.<span style="color:#a6e22e">Allowed</span> = <span style="color:#66d9ef">true</span>

	<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">V</span>(<span style="color:#ae81ff">3</span>).<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Pod %s annotations: %v&#34;</span>, <span style="color:#a6e22e">pod</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">pod</span>.<span style="color:#a6e22e">Annotations</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pod</span>.<span style="color:#a6e22e">Annotations</span>[<span style="color:#e6db74">&#34;injector.test.io/inject&#34;</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;true&#34;</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">reviewResponse</span>
	}

	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">patch</span> []<span style="color:#a6e22e">patchOperation</span>

	<span style="color:#75715e">// patch = append(patch, patchOperation{Op: &#34;add&#34;, Path: &#34;/metadata/annotations&#34;, Value: map[string]string{&#34;injector.test.io/status&#34;: &#34;success&#34;}})
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">added</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;injector.test.io.status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>}
	<span style="color:#a6e22e">patch</span> = append(<span style="color:#a6e22e">patch</span>, <span style="color:#a6e22e">updateAnnotation</span>(<span style="color:#a6e22e">pod</span>.<span style="color:#a6e22e">Annotations</span>, <span style="color:#a6e22e">added</span>)<span style="color:#f92672">...</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">patch</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">pt</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">PatchTypeJSONPatch</span>
		<span style="color:#a6e22e">reviewResponse</span>.<span style="color:#a6e22e">PatchType</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pt</span>
		<span style="color:#a6e22e">reviewResponse</span>.<span style="color:#a6e22e">Patch</span> = <span style="color:#a6e22e">b</span>
	}

	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">reviewResponse</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">injectHandler</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">body</span> []<span style="color:#66d9ef">byte</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Body</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Body</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">body</span> = <span style="color:#a6e22e">data</span>
		}
	}

	<span style="color:#75715e">// verify the content type is accurate
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">contentType</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">contentType</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;application/json&#34;</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;contentType=%s, expect application/json&#34;</span>, <span style="color:#a6e22e">contentType</span>)
		<span style="color:#66d9ef">return</span>
	}

	<span style="color:#a6e22e">requestedAdmissionReview</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionReview</span>{}
	<span style="color:#a6e22e">responseAdmissionReview</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">admissionv1beta1</span>.<span style="color:#a6e22e">AdmissionReview</span>{}

	<span style="color:#a6e22e">deserializer</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">codecs</span>.<span style="color:#a6e22e">UniversalDeserializer</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">deserializer</span>.<span style="color:#a6e22e">Decode</span>(<span style="color:#a6e22e">body</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">requestedAdmissionReview</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">err</span>)
		<span style="color:#a6e22e">responseAdmissionReview</span>.<span style="color:#a6e22e">Response</span> = <span style="color:#a6e22e">toAdmissionResponse</span>(<span style="color:#a6e22e">err</span>)
	} <span style="color:#66d9ef">else</span> {
		<span style="color:#a6e22e">responseAdmissionReview</span>.<span style="color:#a6e22e">Response</span> = <span style="color:#a6e22e">mutatePods</span>(<span style="color:#a6e22e">requestedAdmissionReview</span>)
	}

	<span style="color:#a6e22e">responseAdmissionReview</span>.<span style="color:#a6e22e">Response</span>.<span style="color:#a6e22e">UID</span> = <span style="color:#a6e22e">requestedAdmissionReview</span>.<span style="color:#a6e22e">Request</span>.<span style="color:#a6e22e">UID</span>
	<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">V</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;sending response: %v&#34;</span>, <span style="color:#a6e22e">responseAdmissionReview</span>.<span style="color:#a6e22e">Response</span>)

	<span style="color:#a6e22e">respBytes</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">responseAdmissionReview</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">err</span>)
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">respBytes</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">err</span>)
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">configTLS</span>(<span style="color:#a6e22e">certFile</span>, <span style="color:#a6e22e">keyFile</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">Config</span>, <span style="color:#66d9ef">error</span>) {
	<span style="color:#a6e22e">cert</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">LoadX509KeyPair</span>(<span style="color:#a6e22e">certFile</span>, <span style="color:#a6e22e">keyFile</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
	}

	<span style="color:#a6e22e">tlsConfig</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">Config</span>{
		<span style="color:#a6e22e">Certificates</span>:       []<span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">Certificate</span>{<span style="color:#a6e22e">cert</span>},
		<span style="color:#a6e22e">InsecureSkipVerify</span>: <span style="color:#66d9ef">true</span>,
	}
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tlsConfig</span>, <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">var</span> (
	<span style="color:#a6e22e">certFile</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">keyFile</span>  <span style="color:#66d9ef">string</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">InitFlags</span>(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;logtostderr&#34;</span>, <span style="color:#e6db74">&#34;true&#34;</span>)

	<span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">StringVar</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">certFile</span>, <span style="color:#e6db74">&#34;tls-cert-file&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;File containing the default x509 Certificate for HTTPS.&#34;</span>)
	<span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">StringVar</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">keyFile</span>, <span style="color:#e6db74">&#34;tls-key-file&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;File containing the default x509 private key matching --tls-cert-file.&#34;</span>)

	<span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Parse</span>()
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Flush</span>()
	<span style="color:#75715e">// cfg, err := configTLS(certFile, keyFile)
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// if err != nil {
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// 	klog.Fatalf(&#34;failed to tls config with %v&#34;, err)
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// }
</span><span style="color:#75715e"></span>
	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/pods/inject&#34;</span>, <span style="color:#a6e22e">injectHandler</span>)

	<span style="color:#a6e22e">srv</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Server</span>{
		<span style="color:#a6e22e">Addr</span>: <span style="color:#e6db74">&#34;:9443&#34;</span>,
		<span style="color:#a6e22e">TLSConfig</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">Config</span>{
			<span style="color:#a6e22e">InsecureSkipVerify</span>: <span style="color:#66d9ef">true</span>,
		},
	}
	<span style="color:#a6e22e">klog</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;Admission server starting...&#34;</span>)
	<span style="color:#a6e22e">srv</span>.<span style="color:#a6e22e">ListenAndServeTLS</span>(<span style="color:#a6e22e">certFile</span>, <span style="color:#a6e22e">keyFile</span>)

}
</code></pre></div><h4 id="创建上述服务所使用的证书">创建上述服务所使用的证书</h4>
<ul>
<li>CA</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>root@k8s-1 ~<span style="color:#f92672">]</span>$ cat ca-config.json
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;signing&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;default&#34;</span>: <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;expiry&#34;</span>: <span style="color:#e6db74">&#34;43800h&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;profiles&#34;</span>: <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;server&#34;</span>: <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;expiry&#34;</span>: <span style="color:#e6db74">&#34;43800h&#34;</span>,
                <span style="color:#e6db74">&#34;usages&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#e6db74">&#34;signing&#34;</span>,
                    <span style="color:#e6db74">&#34;key encipherment&#34;</span>,
                    <span style="color:#e6db74">&#34;server auth&#34;</span>
                <span style="color:#f92672">]</span>
            <span style="color:#f92672">}</span>,
            <span style="color:#e6db74">&#34;client&#34;</span>: <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;expiry&#34;</span>: <span style="color:#e6db74">&#34;43800h&#34;</span>,
                <span style="color:#e6db74">&#34;usages&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#e6db74">&#34;signing&#34;</span>,
                    <span style="color:#e6db74">&#34;key encipherment&#34;</span>,
                    <span style="color:#e6db74">&#34;client auth&#34;</span>
                <span style="color:#f92672">]</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>root@k8s-1 ~<span style="color:#f92672">]</span>$ cat ca-csr.json
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;CN&#34;</span>: <span style="color:#e6db74">&#34;cloud.kubernetes&#34;</span>,
  <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;algo&#34;</span>: <span style="color:#e6db74">&#34;rsa&#34;</span>,
    <span style="color:#e6db74">&#34;size&#34;</span>: <span style="color:#ae81ff">2048</span>
  <span style="color:#f92672">}</span>,
  <span style="color:#e6db74">&#34;names&#34;</span>: <span style="color:#f92672">[</span>
    <span style="color:#f92672">{</span>
      <span style="color:#e6db74">&#34;C&#34;</span>: <span style="color:#e6db74">&#34;CN&#34;</span>,
      <span style="color:#e6db74">&#34;ST&#34;</span>: <span style="color:#e6db74">&#34;ZheJiang&#34;</span>,
      <span style="color:#e6db74">&#34;L&#34;</span>: <span style="color:#e6db74">&#34;HangZhou&#34;</span>,
      <span style="color:#e6db74">&#34;O&#34;</span>: <span style="color:#e6db74">&#34;k8s&#34;</span>,
      <span style="color:#e6db74">&#34;OU&#34;</span>: <span style="color:#e6db74">&#34;cloud&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><code>cfssl gencert -initca ca-config.json | cfssljson -bare ca</code></p>
<ul>
<li>Server</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>root@k8s-1 ~<span style="color:#f92672">]</span>$ cat server.json
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;CN&#34;</span>: <span style="color:#e6db74">&#34;cloud.server&#34;</span>,
    <span style="color:#e6db74">&#34;hosts&#34;</span>: <span style="color:#f92672">[</span>
        <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,
        <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>,
        <span style="color:#e6db74">&#34;*.cloud&#34;</span>
    <span style="color:#f92672">]</span>,
    <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;algo&#34;</span>: <span style="color:#e6db74">&#34;rsa&#34;</span>,
        <span style="color:#e6db74">&#34;size&#34;</span>: <span style="color:#ae81ff">2048</span>
    <span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;names&#34;</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;C&#34;</span>: <span style="color:#e6db74">&#34;China&#34;</span>,
            <span style="color:#e6db74">&#34;L&#34;</span>: <span style="color:#e6db74">&#34;HangZhou&#34;</span>,
            <span style="color:#e6db74">&#34;ST&#34;</span>: <span style="color:#e6db74">&#34;ZheJiang&#34;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=server server.json | cfssljson -bare server</code></p>
<ul>
<li>Client</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span>root@k8s-1 ~<span style="color:#f92672">]</span>$ cat client.json
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;CN&#34;</span>: <span style="color:#e6db74">&#34;cloud.client&#34;</span>,
    <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;algo&#34;</span>: <span style="color:#e6db74">&#34;rsa&#34;</span>,
        <span style="color:#e6db74">&#34;size&#34;</span>: <span style="color:#ae81ff">2048</span>
    <span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;names&#34;</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;C&#34;</span>: <span style="color:#e6db74">&#34;China&#34;</span>,
            <span style="color:#e6db74">&#34;L&#34;</span>: <span style="color:#e6db74">&#34;HangZhou&#34;</span>,
            <span style="color:#e6db74">&#34;ST&#34;</span>: <span style="color:#e6db74">&#34;ZheJiang&#34;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=client cient.json | cfssljson -bare client</code></p>
<h4 id="创建admission文件">创建admission文件</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: admissionregistration.k8s.io/v1beta1
<span style="color:#66d9ef">kind</span>: MutatingWebhookConfiguration
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: test-webhook
  <span style="color:#66d9ef">namespace</span>: kube-system
  <span style="color:#66d9ef">labels</span>:
    <span style="color:#66d9ef">app</span>: admission-webhook-injector
<span style="color:#66d9ef">webhooks</span>:
- <span style="color:#66d9ef">name</span>: sidecar-injector.test.io
  <span style="color:#66d9ef">rules</span>:
  - <span style="color:#66d9ef">apiGroups</span>: [<span style="color:#e6db74">&#34;&#34;</span>]
    <span style="color:#66d9ef">apiVersions</span>: [<span style="color:#e6db74">&#34;v1&#34;</span>]
    <span style="color:#66d9ef">operations</span>: [<span style="color:#e6db74">&#34;CREATE&#34;</span>]
    <span style="color:#66d9ef">resources</span>: [<span style="color:#e6db74">&#34;pods&#34;</span>]
  <span style="color:#66d9ef">clientConfig</span>:
    <span style="color:#66d9ef">url</span>: <span style="color:#e6db74">&#34;https://${IP}:9443/pods/inject&#34;</span>
    <span style="color:#66d9ef">caBundle</span>: &lt;pem encoded ca cert that signs the server cert used by the webhook&gt;
</code></pre></div><p>命令： <code>cat ca.pem | base64 | tr -d '\n'</code></p>
<h3 id="testing">Testing</h3>
<h4 id="启动admission服务">启动admission服务</h4>
<p><code>./admission -tls-cert-file certs/server.pem -tls-key-file certs/server-key.pem -v 3</code></p>
<h4 id="创建测试pod的yaml文件">创建测试pod的yaml文件</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Pod
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">annotations</span>:
    <span style="color:#66d9ef">injector.test.io/inject</span>: <span style="color:#e6db74">&#34;true&#34;</span>
  <span style="color:#66d9ef">labels</span>:
    <span style="color:#66d9ef">app</span>: testpod
  <span style="color:#66d9ef">name</span>: testpod
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">containers</span>:
  - <span style="color:#66d9ef">image</span>: k8s.gcr.io/etcd
    <span style="color:#66d9ef">imagePullPolicy</span>: IfNotPresent
    <span style="color:#66d9ef">name</span>: etcd
</code></pre></div><p><code>kubectl apply -f pod.yaml</code></p>
<h4 id="查看新生成的pod发现annotations有injectortestiostatus-success说明admission生效">查看新生成的pod，发现annotations有<code>&quot;injector.test.io.status&quot;: &quot;success&quot;</code>，说明admission生效</h4>
<p><a href="https://www.codercto.com/a/27364.html">Kubernetes 准入控制 Admission Controller 介绍 | Coder·码农网</a></p>
<p><a href="https://my.oschina.net/jxcdwangtao/blog/1591681">深度剖析Kubernetes动态准入控制之Admission Webhooks - WaltonWang&rsquo;s Blog - 开源中国</a></p>
<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/">Dynamic Admission Control - Kubernetes</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://pytimer.github.io/tags/admission-webhook">admission webhook</a></span>
  				</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://pytimer.github.io/">Pytimer</a></span>
            
            
            <span> <a href="https://pytimer.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
